
-- Table TSK_SCHEMA_REGISTRY
CREATE TABLE TASKMANAGER.TSK_SCHEMA_REGISTRY
(
    ID           NUMBER GENERATED BY DEFAULT AS IDENTITY ( START WITH 61 MAXVALUE 9999999999999999999999999999 MINVALUE 1 NOCYCLE CACHE 20 NOORDER NOKEEP NOSCALE) NOT NULL,
    NAME         VARCHAR2(255),
    DESCRIPTION  VARCHAR2(255),
    "SCHEMA"     CLOB
)/*
LOB ("SCHEMA") STORE AS SECUREFILE (
  TABLESPACE  DATA
  ENABLE      STORAGE IN ROW
  CHUNK       8192
  NOCACHE
  LOGGING
      STORAGE    (
                  INITIAL          104K
                  NEXT             1M
                  MINEXTENTS       1
                  MAXEXTENTS       UNLIMITED
                  PCTINCREASE      0
                  BUFFER_POOL      DEFAULT
                 ))
TABLESPACE DATA
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
NOLOGGING
NOCOMPRESS
NOCACHE*/;

ALTER TABLE TASKMANAGER.TSK_SCHEMA_REGISTRY ADD CONSTRAINT PK_TSK_SCHEMA_REGISTRY_ID PRIMARY KEY  (ID);

CREATE OR REPLACE PUBLIC SYNONYM TSK_SCHEMA_REGISTRY FOR TASKMANAGER.TSK_SCHEMA_REGISTRY;


-- Table TSK_TASK_TYPE

CREATE TABLE TASKMANAGER.TSK_TASK_TYPE
(
    ID   NUMBER
        GENERATED ALWAYS AS IDENTITY
            (
            START WITH 61
            MAXVALUE 9999999999999999999999999999
            MINVALUE 1
            NOCYCLE
            CACHE 20
            NOORDER
            NOKEEP
            NOSCALE
            )
        NOT NULL,
    TSK_SCHEMA_REGISTRY_ID    NUMBER,
    WORKFLOW_BUSINESS_KEY     VARCHAR2 (100),
    PROCESS_BUSINESS_KEY      VARCHAR2 (100),
    TASK_DESCRIPTION          VARCHAR2 (250),
    BUCKET_NAME               VARCHAR2 (150),
    SCHEDULE                  VARCHAR2 (150),
    AUTH_CONFIG               CLOB,
    QUERY                     VARCHAR2 (500),
    MAX_LINES                 INTEGER,
    NEEDS_SPLITTING           INTEGER,
    NEEDS_DECOMPOSITION       INTEGER,
    PROCESSING_TYPE           VARCHAR2 (50),
    MAX_COUNT_PER_CHUNK       INTEGER,
    FORM_CONFIG               CLOB,
    INPUT_PATH                VARCHAR2 (500),
    NEEDS_PREVALIDATION       INTEGER,
    INPUT_TYPE                VARCHAR2 (50),
    SHORT_DESCRIPTION         VARCHAR2 (20),
    DELIMITER                 VARCHAR2 (20),
    DISPLAYED                 INTEGER
)/*
LOB (AUTH_CONFIG) STORE AS SECUREFILE
    (TABLESPACE DATA
     ENABLE STORAGE IN ROW
     CHUNK 8192
     NOCACHE LOGGING
     STORAGE (INITIAL 104 K
              NEXT 1 M
              MINEXTENTS 1
              MAXEXTENTS UNLIMITED
              PCTINCREASE 0
              BUFFER_POOL DEFAULT))
LOB (FORM_CONFIG) STORE AS SECUREFILE
    (TABLESPACE DATA
     ENABLE STORAGE IN ROW
     CHUNK 8192
     NOCACHE LOGGING
     STORAGE (INITIAL 104 K
              NEXT 1 M
              MINEXTENTS 1
              MAXEXTENTS UNLIMITED
              PCTINCREASE 0
              BUFFER_POOL DEFAULT))
TABLESPACE DATA
PCTUSED 0
PCTFREE 10
INITRANS 1
MAXTRANS 255
STORAGE (INITIAL 64 K
         NEXT 1 M
         MINEXTENTS 1
         MAXEXTENTS UNLIMITED
         PCTINCREASE 0
         BUFFER_POOL DEFAULT)
NOLOGGING
NOCOMPRESS
NOCACHE*/;


-- Table TSK_TASK_TYPE_UNIQUE

CREATE UNIQUE INDEX TASKMANAGER.TSK_TASK_TYPE_UNIQUE
    ON TASKMANAGER.TSK_TASK_TYPE (SHORT_DESCRIPTION)
    LOGGING
    TABLESPACE INDX
    PCTFREE 10
    INITRANS 2
    MAXTRANS 255
    STORAGE (INITIAL 64 K
    NEXT 1 M
    MINEXTENTS 1
    MAXEXTENTS UNLIMITED
    PCTINCREASE 0
    BUFFER_POOL DEFAULT);

ALTER TABLE TASKMANAGER.TSK_TASK_TYPE ADD CONSTRAINT PK_TSK_TASK_TYPE_ID PRIMARY KEY  (ID);
ALTER TABLE TASKMANAGER.TSK_TASK_TYPE
    ADD (CONSTRAINT TSK_TASK_TYPE_UNIQUE UNIQUE (SHORT_DESCRIPTION)
        USING INDEX TASKMANAGER.TSK_TASK_TYPE_UNIQUE ENABLE VALIDATE);

CREATE OR REPLACE PUBLIC SYNONYM TSK_TASK_TYPE FOR TASKMANAGER.TSK_TASK_TYPE;

ALTER TABLE TASKMANAGER.TSK_TASK_TYPE
    ADD (
        CONSTRAINT FK_TSK_SCHEMA_REGISTRY FOREIGN KEY
            (TSK_SCHEMA_REGISTRY_ID)
            REFERENCES TASKMANAGER.TSK_SCHEMA_REGISTRY (ID)
                ENABLE VALIDATE);

-- Table TSK_TASK

CREATE TABLE TASKMANAGER.TSK_TASK
(
    ID               NUMBER
        GENERATED ALWAYS AS IDENTITY
            (
            START WITH 1
            MAXVALUE 9999999999999999999999999999
            MINVALUE 1
            NOCYCLE
            CACHE 20
            NOORDER
            NOKEEP
            NOSCALE
            )
        NOT NULL,
    TASK_TYPE_ID      NUMBER,
    STATUS            VARCHAR2 (30),
    SCHEDULE_DATE     TIMESTAMP(6),
    MODIFICATION_DATE DATE,
    CREATED_BY        VARCHAR2 (30),
    PAYLOAD           CLOB,
    FORM_INPUT        CLOB,
    URL               CLOB,
    TASK_CONTEXT      CLOB
)/*
LOB (FORM_INPUT) STORE AS SECUREFILE
    (TABLESPACE DATA
     ENABLE STORAGE IN ROW
     CHUNK 8192
     NOCACHE LOGGING
     STORAGE (INITIAL 104 K
              NEXT 1 M
              MINEXTENTS 1
              MAXEXTENTS UNLIMITED
              PCTINCREASE 0
              BUFFER_POOL DEFAULT))
LOB (PAYLOAD) STORE AS SECUREFILE
    (TABLESPACE DATA
     ENABLE STORAGE IN ROW
     CHUNK 8192
     NOCACHE LOGGING
     STORAGE (INITIAL 104 K
              NEXT 1 M
              MINEXTENTS 1
              MAXEXTENTS UNLIMITED
              PCTINCREASE 0
              BUFFER_POOL DEFAULT))
LOB (TASK_CONTEXT) STORE AS SECUREFILE (
  TABLESPACE  DATA
  ENABLE      STORAGE IN ROW
  CHUNK       8192
  NOCACHE
  LOGGING
      STORAGE    (
                  INITIAL          104K
                  NEXT             1M
                  MINEXTENTS       1
                  MAXEXTENTS       UNLIMITED
                  PCTINCREASE      0
                  BUFFER_POOL      DEFAULT
                 ))
LOB (URL) STORE AS SECUREFILE
    (TABLESPACE DATA
     ENABLE STORAGE IN ROW
     CHUNK 8192
     NOCACHE LOGGING
     STORAGE (INITIAL 104 K
              NEXT 1 M
              MINEXTENTS 1
              MAXEXTENTS UNLIMITED
              PCTINCREASE 0
              BUFFER_POOL DEFAULT))
TABLESPACE DATA
PCTUSED 0
PCTFREE 10
INITRANS 1
MAXTRANS 255
STORAGE (INITIAL 64 K
         NEXT 1 M
         MINEXTENTS 1
         MAXEXTENTS UNLIMITED
         PCTINCREASE 0
         BUFFER_POOL DEFAULT)
NOLOGGING
NOCOMPRESS
NOCACHE*/;
